!function(t){t.fn.famultibutton=function(o){function e(){h=!0,u.children().filter("#bg").css("color",O.onBackgroundColor),u.children().filter("#fg").css("color",O.onColor)}function n(){h=!1,u.children().filter("#bg").css("color",O.offBackgroundColor),u.children().filter("#fg").css("color",O.offColor)}function i(){h&&(h=!1,t("<div />").animate({width:100},{duration:700,easing:"swing",step:function(t,o){var e=(t-o.start)/(o.end-o.start);u.children().filter("#bg").css("color",getGradientColor(O.onBackgroundColor,O.offBackgroundColor,e)),u.children().filter("#fg").css("color",getGradientColor(O.onColor,O.offColor,e))}}))}function l(o){var e=u.find("canvas#progress");if(o>0){0==e.length&&(e=t("<canvas>").attr({id:"progress"}).appendTo(u));var n=e[0];if(n){n.height=u.height(),n.width=u.width();var i=n.width/2,l=n.height/2;if(n.getContext){var a=n.getContext("2d");a.beginPath(),a.strokeStyle=O.onColor,a.arc(.97*i,1.02*l,.85*i,-.5*Math.PI,(-.5+2*o)*Math.PI,!1),a.lineWidth=3,a.stroke()}}}else u.find("canvas#progress").remove()}function a(){clearTimeout(f),v=m>0?v-=1:v+=1,v>100&&(v=100),0>v&&(v=0),s();var t=d[Math.abs(m)];f=setTimeout(function(){a()},500-t)}function s(){var t=c[0];if(t.height=u.innerHeight(),t.width=u.innerWidth(),t.getContext){var o=t.getContext("2d");o.strokeStyle=O.offBackgroundColor;for(var e=t.height-Math.round(t.height*v/100),n=0;n<t.height;n+=4)o.lineWidth=1,o.beginPath(),o.moveTo(5,n),o.lineTo(25,n),o.stroke();o.strokeStyle=h?O.onBackgroundColor:getGradientColor(O.offBackgroundColor,"#ffffff",.4),o.lineWidth=3,o.beginPath(),o.moveTo(5,e),o.lineTo(25,e),o.stroke(),o.fillStyle=getGradientColor(O.offBackgroundColor,"#ffffff",.4),o.font="10px sans-serif",o.fillText(v,30,t.height)}}function r(){c.css({position:"absolute","z-index":-1}),c.animate(k?{left:.6*-u.innerWidth()+"px"}:{left:u.innerWidth()/5+"px",top:C})}if(this.length>1)return this.each(function(){t(this).famultibutton(o)}),this;var c,f,u=this,h=!1,g=!1,d=[0,10,40,80,120,140,150,160,180,200,240,260,280,300,320,420,430,440,450,460,470],p=0,v=0,m=0,C=0,b=0,k=!1,x=!1,y={backgroundIcon:"fa-circle",classes:["fa-2x"],icon:"fa-power-off",offColor:"#2A2A2A",offBackgroundColor:"#505050",onColor:"#2A2A2A",onBackgroundColor:"#aa6900",mode:"toggle",toggleOn:null,toggleOff:null,valueChanged:null},O=t.extend({},y,o),I=function(){if(O=t.extend({},O,u.data()),u.addClass("fa-stack"),jQuery("<i/>",{id:"bg","class":"fa fa-stack-2x"}).addClass(O.backgroundIcon).appendTo(u),jQuery("<i/>",{id:"fg","class":"fa fa-stack-1x"}).addClass(O.icon).appendTo(u),O.classes&&O.classes.length>0)for(var o=0;o<O.classes.length;o++)u.addClass(O.classes[o]);return n(),"dimmer"==O.mode&&(t("<canvas>").attr({id:"scale"}).appendTo(u),c=u.find("canvas#scale"),c.css({height:u.innerHeight()+4}),C=parseInt(c.offset().top)-parseInt(u.offset().top),s(),r()),u.data("famultibutton",u),u};if(getGradientColor=function(t,o,e){t=t.replace(/^\s*#|\s*$/g,""),o=o.replace(/^\s*#|\s*$/g,""),3==t.length&&(t=t.replace(/(.)/g,"$1$1")),3==o.length&&(o=o.replace(/(.)/g,"$1$1"));var n=parseInt(t.substr(0,2),16),i=parseInt(t.substr(2,2),16),l=parseInt(t.substr(4,2),16),a=parseInt(o.substr(0,2),16),s=parseInt(o.substr(2,2),16),r=parseInt(o.substr(4,2),16),c=a-n,f=s-i,u=r-l;return c=(c*e+n).toString(16).split(".")[0],f=(f*e+i).toString(16).split(".")[0],u=(u*e+l).toString(16).split(".")[0],1==c.length&&(c="0"+c),1==f.length&&(f="0"+f),1==u.length&&(u="0"+u),"#"+c+f+u},"push"==O.mode){var T=null!==document.ontouchstart?"mousedown":"touchstart",B=null!==document.ontouchend?"mouseup":"touchend",w=null!==document.ontouchleave?"mouseout":"touchleave";this.bind(T,function(){e(),"function"==typeof O.toggleOn&&O.toggleOn.call(this)}),this.bind(B,function(){i()}),this.bind(w,function(){i()})}else if("toggle"==O.mode){var T=null!==document.ontouchstart?"click":"touchstart";this.bind(T,function(t){h?(n(),"function"==typeof O.toggleOff&&O.toggleOff.call(this)):(e(),"function"==typeof O.toggleOn&&O.toggleOn.call(this)),t.preventDefault()})}else if("dimmer"==O.mode){var T=null!==document.ontouchstart?"mousedown":"touchstart",S=null!==document.ontouchmove?"mousemove":"touchmove",B=null!==document.ontouchend?"mouseup":"touchend",w=null!==document.ontouchleave?"mouseout":"touchleave";this.bind(T,function(t){var o=t.originalEvent;p=o.touches?o.touches[0].clientY:t.pageY,m=0,x=!0,t.preventDefault()}),this.bind(w,function(t){k&&(k=!1,u.animate({top:0}),clearInterval(f),g=!1,r()),x=!1,t.preventDefault()}),this.bind(B,function(t){k?(k=!1,u.animate({top:0}),clearTimeout(f),g=!1,"function"==typeof O.valueChanged&&O.valueChanged.call(this,v)):h?(n(),"function"==typeof O.toggleOff&&O.toggleOff.call(this)):(e(),"function"==typeof O.toggleOn&&O.toggleOn.call(this)),k=!1,x=!1,r(),s(),t.preventDefault()}),this.bind(S,function(t){x&&(k=!0);var o=t.originalEvent;b=o.touches?o.touches[0].clientY:t.pageY,m=b-p,m>20&&(m=20),-20>m&&(m=-20),k&&(this.style.top=m+"px",g||(r(),a(),g=!0),c.css({top:-m+"px"})),t.preventDefault()})}return this.setOn=function(){e()},this.setOff=function(){n()},this.getState=function(){return h},this.getValue=function(){return v},this.setDimValue=function(t){v=t,s()},this.setProgressValue=function(t){l(t)},I()}}(jQuery);
