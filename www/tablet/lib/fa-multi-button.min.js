"use strict";!function(t){t.fn.famultibutton=function(e){function x(){o=!0,i.children().children("#bg").css("color",v.onBackgroundColor),i.children().children("#fg").css("color",v.onColor),n.trigger("setOn")}function w(){o=!1,i.children().children("#bg").css("color",v.offBackgroundColor),i.children().children("#fg").css("color",v.offColor),n.trigger("setOff")}function y(){o&&(o=!1,t("<div />").animate({width:100},{duration:700,easing:"swing",step:function(t,e){var n=(t-e.start)/(e.end-e.start);i.children().children("#bg").css("color",C(v.onBackgroundColor,v.offBackgroundColor,n)),i.children().children("#fg").css("color",C(v.onColor,v.offColor,n))}}))}function k(t){var e=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return e&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):t}function C(t,e,n){t=k(t).replace(/^\s*#|\s*$/g,""),e=k(e).replace(/^\s*#|\s*$/g,""),3==t.length&&(t=t.replace(/(.)/g,"$1$1")),3==e.length&&(e=e.replace(/(.)/g,"$1$1"));var i=parseInt(t.substr(0,2),16),o=parseInt(t.substr(2,2),16),s=parseInt(t.substr(4,2),16),a=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2,2),16),l=parseInt(e.substr(4,2),16),f=a-i,c=r-o,u=l-s;return f=(f*n+i).toString(16).split(".")[0],c=(c*n+o).toString(16).split(".")[0],u=(u*n+s).toString(16).split(".")[0],1==f.length&&(f="0"+f),1==c.length&&(c="0"+c),1==u.length&&(u="0"+u),"#"+f+c+u}function I(e){var o=n.find("canvas#progress");if(e>0){0===o.length&&(o=t("<canvas>").attr({id:"progress"}).appendTo(i));var s=o[0];if(s){s.height=i.height(),s.width=i.width();var a=s.width/2,r=s.height/2;if(s.getContext){var l=s.getContext("2d");l.beginPath(),l.strokeStyle=v.onColor,l.arc(a,r,a*(-.4/90*Number(v.progressWidth)+.8),-.5*Math.PI,(-.5+2*e)*Math.PI,!1),l.lineWidth=.8*a*v.progressWidth/100,l.stroke()}}}else n.find("canvas#progress").remove()}function T(){clearTimeout(a),c=u>0?c-=v.step:c+=v.step,c>v.max&&(c=v.max),c<v.min&&(c=v.min),O();var t=l[Math.abs(u)];a=setTimeout(function(){T()},500-t)}function O(){var t=s[0];if(t.height=i.innerHeight(),t.width=i.innerWidth(),t.getContext){var e=t.getContext("2d");e.strokeStyle=v.offBackgroundColor;for(var n=v.max,a=v.min,r=t.height-Math.round(t.height*(c-a)/(n-a)),l=0;l<t.height;l+=4)e.lineWidth=1,e.beginPath(),e.moveTo(5,l),e.lineTo(25,l),e.stroke();e.strokeStyle=o?v.onBackgroundColor:C(v.offBackgroundColor,"#ffffff",.4),e.lineWidth=3,e.beginPath(),e.moveTo(5,r),e.lineTo(25,r),e.stroke(),e.fillStyle=C(v.offBackgroundColor,"#ffffff",.4),e.font="10px sans-serif",e.fillText(c,30,t.height)}}function j(){s.css({position:"absolute","z-index":-1}),d?s.animate({left:.6*-i.innerWidth()+"px"}):s.animate({left:i.innerWidth()/5+"px"})}function P(t){t=(t||navigator.userAgent).toLowerCase();var e=t.match(/android\s([0-9\.]*)/);return e?e[1]:!1}if(this.length>1)return this.each(function(){t(this).famultibutton(e)}),this;var i,s,a,D,S,E,n=this,o=!1,r=!1,l=[0,10,40,80,120,140,150,160,180,200,240,260,280,300,320,420,430,440,450,460,470],f=0,c=0,u=0,h=0,p=0,d=!1,g=!1,m={backgroundIcon:"fa-circle",classes:["fa-2x"],icon:"fa-power-off",offColor:"#2A2A2A",offBackgroundColor:"#505050",onColor:"#2A2A2A",onBackgroundColor:"#aa6900",mode:"toggle",toggleOn:null,toggleOff:null,valueChanged:null,progressWidth:15,max:100,min:0,step:1},v=t.extend({},m,e),b=function(){v=t.extend({},v,n.data());var e=n.html()!==n.text()?n.find("*").detach():jQuery("<div>",{}).text(n.text());if(e.attr("id","fg"),e.addClass("fa-stack-1x"),n.html(""),i=t("<div/>",{"class":"famultibutton"}).appendTo(n),i.addClass("fa-stack"),jQuery("<i/>",{id:"bg","class":"fa fa-stack-2x"}).addClass(v.backgroundIcon).appendTo(i),jQuery("<i/>",{id:"fg","class":"fa fa-stack-1x"}).addClass(v.icon).appendTo(i),e.appendTo(i),v.classes&&v.classes.length>0)for(var o=0;o<v.classes.length;o++)i.addClass(v.classes[o]);return n.o=v,w(),"dimmer"==v.mode&&(s=t("<canvas>").attr({id:"scale",height:n.height()+"px",width:n.width()+"px"}).appendTo(i),h=parseInt(s.offset().top)-parseInt(i.offset().top),O(),j()),n.data("famultibutton",n),n},$=P(),M=$&&parseFloat($)<5,B=M?"touchstart":"touchstart mousedown",A=M?"touchmove":"touchmove mousemove",W=M?"touchend":"touchend mouseup",L=M?"touchleave":"touchleave mouseout";return"push"==v.mode?(this.on(B,function(e){e.preventDefault(),e.stopImmediatePropagation(),S=t(window).scrollTop(),D=t(window).scrollLeft()}),this.on(W,function(e){return e.preventDefault(),e.stopImmediatePropagation(),Math.abs(S-t(window).scrollTop())>3||Math.abs(D-t(window).scrollLeft())>3?void 0:(E=o,x(),"function"==typeof v.toggleOn&&v.toggleOn.call(this),setTimeout(function(){y()},200),E===!0&&setTimeout(function(){x()},1e3),setTimeout(function(){o===!0&&x()},1200),n.trigger("clicked"),!1)})):"updown"==v.mode?(this.on(B,function(t){t.preventDefault(),t.stopImmediatePropagation(),E=o,x(),"function"==typeof v.toggleOn&&v.toggleOn.call(this)}),this.on(W,function(t){return t.preventDefault(),t.stopImmediatePropagation(),"function"==typeof v.toggleOff&&v.toggleOff.call(this),setTimeout(function(){y()},200),E===!0&&setTimeout(function(){x()},1e3),setTimeout(function(){o===!0&&x()},1200),n.trigger("clicked"),!1})):"toggle"==v.mode?(this.on(B,function(e){e.preventDefault(),e.stopImmediatePropagation(),S=t(window).scrollTop(),D=t(window).scrollLeft()}),this.on(W,function(e){return e.preventDefault(),e.stopImmediatePropagation(),Math.abs(S-t(window).scrollTop())>3||Math.abs(D-t(window).scrollLeft())>3?void 0:(o?(w(),"function"==typeof v.toggleOff&&v.toggleOff.call(this)):(x(),"function"==typeof v.toggleOn&&v.toggleOn.call(this)),n.trigger("clicked"),!1)})):"dimmer"==v.mode&&(this.on(B,function(t){t.preventDefault(),t.stopImmediatePropagation();var e=t.originalEvent;f=e.touches?e.touches[0].clientY:t.pageY,u=0,g=!0}),this.on(L,function(t){t.preventDefault(),t.stopImmediatePropagation(),d&&(d=!1,n.animate({top:0}),clearInterval(a),r=!1,j()),g=!1}),this.on(W,function(t){return t.preventDefault(),t.stopImmediatePropagation(),d?(d=!1,n.animate({top:0}),clearTimeout(a),r=!1,"function"==typeof v.valueChanged&&v.valueChanged.call(this,c)):o?(w(),"function"==typeof v.toggleOff&&v.toggleOff.call(this)):(x(),"function"==typeof v.toggleOn&&v.toggleOn.call(this)),d=!1,g=!1,j(),O(),n.trigger("clicked"),!1}),this.on(A,function(t){t.preventDefault(),t.stopImmediatePropagation(),g&&(d=!0);var e=t.originalEvent;p=e.touches?e.touches[0].clientY:t.pageY,u=p-f,u>20&&(u=20),-20>u&&(u=-20),d&&(this.style.top=u+"px",r||(j(),T(),r=!0))})),this.setOn=function(){x()},this.setOff=function(){w()},this.getState=function(){return o},this.getValue=function(){return c},this.setDimValue=function(t){c=t,O()},this.setProgressValue=function(t){I(t)},b()}}(jQuery);